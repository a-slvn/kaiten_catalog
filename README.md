# CRM Kanban Board

Интерфейс CRM с канбан-доской для управления сделками, построенный на React + Vite + Material-UI.

## Возможности

### Канбан-доска
- 6 колонок для управления воронкой продаж (Новый, Квалификация, Предложение, Переговоры, Оплачено, Потеряно)
- Drag & Drop для перемещения сделок между колонками
- Карточки сделок с информацией о клиенте, сумме, статусе и ответственном
- Подсчет общей суммы по каждой колонке

### Кастомные поля и справочники
- Конструктор кастомных полей с поддержкой 10+ типов полей
- Справочники (reference fields) для создания связанных сущностей
- Поддержка множественного выбора (multiselect)
- Связи между справочниками (например, Контакты → Компании)

### Модальные окна для контактов и компаний
- **Просмотр информации**: Все поля записи с правильным форматированием
- **Связанные записи**: Навигация между контактами и компаниями
- **Связанные сделки**: Список сделок с визуальным отображением
- **Редактирование**: Полноценная форма редактирования с валидацией
- **Навигация**: Переход между связанными записями одним кликом

### Рабочая область данных
- Таблицы с фильтрацией и сортировкой
- Настройка видимости полей
- Управление доступом (пользователи/группы)
- Клик по записи открывает модальное окно

### Дополнительно
- Верхняя панель навигации с иконками
- Полностью типизированный код на TypeScript
- Хранение данных в localStorage
- Адаптивный дизайн

## Технологии

- React 18
- TypeScript
- Vite
- Material-UI (MUI) v5
- @dnd-kit (drag & drop)
- Emotion (CSS-in-JS)

## Структура проекта

```
src/
├── components/                      # React компоненты
│   ├── TopBar.tsx                   # Верхняя панель навигации
│   ├── Sidebar.tsx                  # Боковая панель
│   ├── KanbanBoard.tsx              # Канбан-доска с drag & drop
│   ├── KanbanColumn.tsx             # Колонка канбана
│   ├── DealCard.tsx                 # Карточка сделки
│   ├── DealModal.tsx                # Модальное окно сделки
│   ├── ReferenceRecordModal.tsx     # Модальное окно контакта/компании
│   ├── CustomFieldsPage.tsx         # Страница управления полями
│   ├── FieldsWorkspacePage.tsx      # Рабочая область с таблицами
│   ├── CustomFieldBuilder.tsx       # Конструктор полей
│   ├── ReferenceFieldCard.tsx       # Карточка справочника
│   ├── ReferenceFieldDisplay.tsx    # Отображение reference поля
│   ├── ReferenceFieldSelect.tsx     # Выбор из справочника
│   ├── CreateReferenceEntryDialog.tsx # Создание записи справочника
│   └── AddFieldMenu.tsx             # Меню добавления полей
├── context/                         # React контексты
│   ├── CustomFieldsContext.tsx      # Контекст кастомных полей
│   ├── ReferenceEntriesContext.tsx  # Контекст записей справочников
│   └── DealsContext.tsx             # Контекст сделок
├── hooks/                           # Кастомные хуки
│   └── useDeals.ts                  # Хук для работы со сделками
├── types/                           # TypeScript типы
│   └── index.ts                     # Все типы приложения
├── data/                            # Mock данные
│   └── mockData.ts                  # Начальные данные
├── theme/                           # MUI тема
│   └── theme.ts                     # Кастомная тема
├── App.tsx                          # Главный компонент
└── main.tsx                         # Точка входа
```

## Установка и запуск

### Установка зависимостей
```bash
npm install
```

### Запуск dev сервера
```bash
npm run dev
```

Приложение будет доступно на http://localhost:5173/

### Сборка для продакшена
```bash
npm run build
```

### Предпросмотр production сборки
```bash
npm run preview
```

## Использование

### Быстрый старт

1. **Канбан-доска**:
   - Просмотр сделок в колонках по статусам
   - Перемещение сделок между колонками (Drag & Drop)
   - Клик на карточку сделки для открытия деталей

2. **Кастомные поля**:
   - Создайте справочники для Компаний и Контактов
   - Добавьте поля разных типов (текст, email, телефон, reference)
   - Настройте связи между справочниками

3. **Модальные окна**:
   - Перейдите в "Данные CRM"
   - Кликните на запись в таблице
   - Изучите вкладки: Информация, Связанные, Сделки, Редактирование
   - Кликайте на связанные записи для навигации

### Пример создания структуры данных

1. Создайте справочник "Компании":
   ```
   Поля: Название, Адрес, Телефон, Email
   ```

2. Создайте справочник "Контакты":
   ```
   Поля: ФИО, Должность, Телефон, Email
   Reference поле: Компания (ссылка на справочник Компании)
   ```

3. Добавьте записи в справочники

4. В карточке сделки добавьте поля "Контакт" и "Компания"

5. Откройте "Данные CRM" и исследуйте связи

### Детальные руководства

- [QUICK_START_MODALS.md](QUICK_START_MODALS.md) - Быстрый старт с модальными окнами
- [MODAL_WINDOWS_GUIDE.md](MODAL_WINDOWS_GUIDE.md) - Подробное руководство по модальным окнам
- [USER_GUIDE.md](USER_GUIDE.md) - Общее руководство пользователя
- [REFERENCE_LINKS_GUIDE.md](REFERENCE_LINKS_GUIDE.md) - Руководство по справочникам

## Данные

В текущей версии используются mock данные из файла [src/data/mockData.ts](src/data/mockData.ts).

Для интеграции с реальным API:
1. Создайте сервис для работы с API
2. Замените mock данные на запросы к серверу
3. Обновите state management в компоненте KanbanBoard

## Настройка темы

Тема Material-UI настраивается в файле [src/theme/theme.ts](src/theme/theme.ts).

Можно изменить:
- Цветовую палитру
- Шрифты
- Стили компонентов

## Лицензия

MIT
